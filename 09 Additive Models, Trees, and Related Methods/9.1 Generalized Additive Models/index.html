<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="The Elements of Statistical Learning(ESL) 的中文翻译">
        
        <link rel="canonical" href="https://szcf-weiya.github.io/ESL-CN/09 Additive Models, Trees, and Related Methods/9.1 Generalized Additive Models/">
	<link rel="shortcut icon" href="../../img/favicon.ico">

	<title>9.1 广义加性模型 - ESL CN</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/newsprint.css" rel="stylesheet">
        <link href="../../css/admonition_fix.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-85046550-1', 'auto');
          ga('send', 'pageview');

        </script>
<!--
	<style>
	  .dropdown-menu {
    max-height: 500px;
    overflow-y: auto;
    overflow-x: auto;
}
	</style>
-->
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="">ESL CN</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">主页</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">目录 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">序言</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../Preface/2016-07-20-Preface-to-the-Second-Edition/">第二版序言</a>
</li>

        
            
<li >
    <a href="../../Preface/2016-07-21-Preface-to-the-First-Edition/">第一版序言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">1 简介</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../01 Introduction/2016-07-26-Chapter-1-Introduction/">1.1 导言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">2 监督学习概要</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.1 Introduction/">2.1 导言</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.2 Variable Types and Terminology/">2.2 变量类型和术语</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.3 Two Simple Approaches to Prediction/">2.3 两种预测的简单方法</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.4 Statistical Decision Theory/">2.4 统计判别理论</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.5 Local Methods in High Dimensions/">2.5 高维问题的局部方法</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.6 Statistical Models, Supervised Learning and Function Approximation/">2.6 统计模型，监督学习和函数逼近</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.7 Structured Regression Models/">2.7 结构化的回归模型</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.8 Classes of Restricted Estimators/">2.8 限制性估计的类别</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.9 Model Selection and the Bias-Variance Tradeoff/">2.9 模型选择和偏差-方差的权衡</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">3 回归的线性方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.1 Introduction/">3.1 导言</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.2 Linear Regression Models and Least Squares/">3.2 线性回归模型和最小二乘法</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.3 Subset Selection/">3.3 子集的选择</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.4 Shrinkage Methods/">3.4 收缩的方法</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.5 Methods Using Derived Input Directions/">3.5 运用派生输入方向的方法</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.6 A Comparison of the Selection and Shrinkage Methods/">3.6 选择和收缩方法的比较</a>
</li>

        
            
<li >
    <a href="../../03 Linear Methods for Regression/3.7 Multiple Outcome Shrinkage and Selection/">3.7 多重输出的收缩和选择</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">4 分类的线性方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.1 Introduction/">4.1 导言</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.2 Linear Regression of an Indicator Matrix/">4.2 指示矩阵的线性回归</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.3 Linear Discriminant Analysis/">4.3 线性判别分析</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.4 Logistic Regression/">4.4 逻辑斯蒂回归</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.5 Separating Hyperplanes/">4.5 分离超平面</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">5 基展开和正规化</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.1 Introduction/">5.1 导言</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.2 Piecewise Polynomials and Splines/">5.2 分段多项式和样条</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.3 Filtering and Feature Extraction/">5.3 滤波和特征提取</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.4 Smoothing Splines/">5.4 光滑样条</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">6 核光滑方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.0 Introduction/">6.0 导言</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.1 One-Dimensional Kernel Smoothers/">6.1 一维核光滑器</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.2 Selecting the Width of the Kernel/">6.2 选择核的宽度</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.3 Local Regression in R^p/">6.3 $R^p$中的局部回归</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">7 模型评估及选择</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.1 Introduction/">7.1 导言</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.2 Bias, Variance and Model Complexity/">7.2 偏差，方差和模型复杂度</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.3 The Bias-Variance Decomposition/">7.3 偏差-方差分解</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.4 Optimism of the Training Error Rate/">7.4 测试误差率的乐观</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.5 Estimates of In-Sample Prediction Error/">7.5 样本内预测误差的估计</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.6 The Effective Number of Parameters/">7.6 参数的有效个数</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.7 The Bayesian Approach and BIC/">7.7 贝叶斯方法和BIC</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.8 Minimum Description Length/">7.8 最小描述长度</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.9 Vapnik-Chervonenkis Dimension/">7.9 VC维</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.10 Cross-Validation/">7.10 交叉验证</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.11 Bootstrap Methods/">7.11 自助法</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.12 Conditional or Expected Test Error/">7.12 条件测试误差或期望测试误差</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">8 模型推断和平均</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.1 Introduction/">8.1 导言</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.2 The Bootstrap and Maximum Likelihood Methods/">8.2 自助法和最大似然法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.3 Bayesian Methods/">8.3 贝叶斯方法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.4 Relationship Between the Bootstrap and Bayesian Inference/">8.4 自助法和贝叶斯推断之间的关系</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.5 The EM Algorithm/">8.5 EM算法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.6 MCMC for Sampling from the Posterior/">8.6 MCMC向后采样</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.7 Bagging/">8.7 袋装法</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">9 增广模型，树，以及相关方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../9.0 Introduction/">9.0 导言</a>
</li>

        
            
<li class="active">
    <a href="./">9.1 广义加性模型</a>
</li>

        
            
<li >
    <a href="../9.2 Tree-Based Methods/">9.2 基于树的方法</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">10 增强和加性树</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.1 Boosting Methods/">10.1 增强方法</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.2 Boosting Fits an Additive Model/">10.2 对加性模型的增强拟合</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.3 Forward Stagewise Additive Modeling/">10.3 向前逐步加性建模</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.4 Exponential Loss and AdaBoost/">10.4 指数损失和AdaBoost</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.5 Why Exponential Loss/">10.5 为什么是指数损失</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.6 Loss Functions and Robustness/">10.6 损失函数和鲁棒性</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">11 神经网络</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../11 Neural Networks/11.1 Introduction/">11.1 导言</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.2 Projection Pursuit Regression/">11.2 投影寻踪回归</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.3 Neural Networks/">11.3 神经网络</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.4 Fitting Neural Networks/">11.4 拟合神经网络</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.5 Some Issues in Training Neural Networks/">11.5 训练神经网络的一些问题</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.6 Example of Simulated Data/">11.6 模拟数据的例子</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">12 支持向量机和灵活的判别方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../12 Support Vector Machines and Flexible Discriminants/12.1 Introduction/">12.1 导言</a>
</li>

        
            
<li >
    <a href="../../12 Support Vector Machines and Flexible Discriminants/12.2 The Support Vector Classifier/">12.2 支持向量分类器</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">13 原型方法和最近邻</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.1 Introduction/">13.1 导言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">14 非监督学习</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../14 Unsupervised Learning/14.1 Introduction/">14.1 导言</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.2 Association Rules/">14.2 关联规则</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.3 Cluster Analysis/">14.3 聚类分析</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">15 随机森林</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../15 Random Forests/15.1 Introduction/">15.1 导言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">17 无向图模型</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.1 Introduction/">17.1 导言</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.2 Markov Graphs and Their Properties/">17.2 马尔科夫图及其性质</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.3 Undirected Graphical Models for Continuous Variables/">17.3 连续变量的无向图模型</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.4 Undirected Graphical Models for Discrete Variables/">17.4 离散变量的无向图模型</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> 搜索
                    </a>
                </li>
                <li >
                    <a rel="next" href="../9.0 Introduction/">
                        <i class="fa fa-arrow-left"></i> 上一节
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../9.2 Tree-Based Methods/">
                        下一节 <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://szcf-weiya.github.io">
                        
                        Szcf-Weiya
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1">广义加性模型</a></li>
        
            <li><a href="#_2">拟合加性模型</a></li>
        
            <li><a href="#_3">例子：加性逻辑斯蒂回归</a></li>
        
            <li><a href="#_4">例子：预测垃圾邮件</a></li>
        
            <li><a href="#_5">总结</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="_1">广义加性模型</h1>
<table>
<thead>
<tr>
<th>原文</th>
<th><a href="../../book/The Elements of Statistical Learning.pdf">The Elements of Statistical Learning</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>翻译</td>
<td>szcf-weiya</td>
</tr>
<tr>
<td>时间</td>
<td>2017-02-04</td>
</tr>
</tbody>
</table>
<p>回归模型在许多数据分析中起着重要的作用，提供了预测和分类的规则、以及理解不同输入重要性的数据分析工具。</p>
<p>尽管非常简单，但是传统的线性模型经常在这些情形下失效：实际生活中影响往往不是线性的。在前面的章节中我们讨论使用预定义的基函数来实现非线性的技巧。这部分描述更多自动的灵活的统计方法来识别和表征非线性回归的影响。这些方法被称为“广义加性模型”。</p>
<p>在回归的设定中，一个广义加性模型有如下形式
<script type="math/tex; mode=display">
E(Y\mid X_1,X_2,\ldots,X_p) = \alpha+f_1(X_1)+f_2(X_2)+\cdots+f_p(X_p).\qquad (9.1)
</script>
</p>
<p>和通常一样，$X_1,X_2,\ldots,X_p$代表预报变量，$Y$表示输出；$f_j$是未定义的（非参）光滑函数。如果我们用基函数的展开（第5章）对每个函数进行建模，则最终的模型可以通过简单的最小二乘实现。我们这里的方式有些不同：我们用散点图光滑来拟合每个函数（比如，一个三次光滑样条或者核光滑），并且提供了同时估计所有$p$个函数的算法（9.1.1节）</p>
<p>对于两个类别的分类，回忆在4.4节中讨论的二进制数据的逻辑斯蒂回归模型。我们通过一个线性回归模型和logit链接函数将预报变量与二进制响应变量的均值$\mu(X)=Pr(Y=1\mid X)$关联起来：
<script type="math/tex; mode=display">
\mathrm{log}(\frac{\mu(X)}{1-\mu(X)})=\alpha+\beta_1X_1+\cdots+\beta_pX_p\qquad (9.2)
</script>
加性逻辑斯蒂回归模型将每个线性项换成一个更一般的函数形式
<script type="math/tex; mode=display">
\mathrm{log}(\frac{\mu(X)}{1-\mu(X)})=\alpha+f_1(X_1)+f_2(X_2)+\cdots+f_p(X_p)\qquad (9.3)
</script>
其中每个$f_j$也是未定义的光滑函数。尽管函数$f_j$的非参形式使得模型更加灵活，但是可加性仍然保留，而且允许我们用前面一样的方式来解读模型。加性逻辑斯蒂回归模型是广义加性模型的一个例子。一般地，响应变量$Y$的条件均值$\mu(X)$通过一个链接函数$g$将预报变量的加性函数联系起来：
<script type="math/tex; mode=display">
g[\mu(X)]=\alpha+f_1(X_1)+\cdots+f_p(X_p)\qquad (9.4)
</script>
典型的链接函数的例子如下：</p>
<ul>
<li>$g(\mu)=\mu$是等值链接，在高斯相应数据中使用线性和加性模型</li>
<li>$g(\mu)=logit(\mu)$如上面所示，或者$g(\mu)=probit(\mu)$，是对二项概率建模的probit链接函数。probit函数是高斯累计分布函数的反函数：$probit(\mu)=\Phi^{-1}(\mu)$</li>
<li>$g(\mu)=log(\mu)$应用于处理泊松计数数据的对数线性或者对数加性模型。</li>
</ul>
<p>上面的三种情形都是来自指数族采样模型，另外也包括gamma分布和非负二项分布。这个分布族产生著名的广义线性模型，它们都是以同样的方式扩展为广义加性模型。</p>
<p>函数$f_j$以一种灵活的方式来估计，使用其基本构造块是散点图平滑器的算法。估计函数$\hat f_j$然后可以揭示$X_j$可能的非线性影响。并不是所有的函数$f_j$需要是非线性。我们可以简单地将线性项和其它参数形式与非线性项混合，当一些输入是定性变量（因子）时是必要的。非线性项也没有限制成主要影响；我们可以在两个或更多的变量中有非线性成分，对于因子$X_k$的每个层次关于$X_j$的单独曲线。因此下列的每个都会有资格：</p>
<ul>
<li>$g(\mu)=X^T\beta+\alpha_k+f(Z)$——一个半参模型，其中$X$是为了线性建模的预报变量的向量，$\alpha_k$是定性输入$V$的第$k$个层次的影响，而且预报变量$Z$的影响是非参数地建模。</li>
<li>$g(\mu)=f(X)+g_k(Z)$——再一次$k$对定性输入$V$的层次进行编号，因此构造出一个关于$V$和$Z$影响的交叉项$g(V,Z)=g_k(Z)$</li>
<li>$g(\mu)=f(X)+g(Z,W)$，其中$g$是关于两个特征的非参数函数。</li>
</ul>
<p>加性模型可以用各种设置来替换线性模型，举个例子，时间序列的可加性分解，
<script type="math/tex; mode=display">
Y_t=S_t+T_t+\varepsilon_t\qquad (9.5)
</script>
其中，$S_t$是季节项，$T_t$是趋势项，$\varepsilon$是误差项。</p>
<h2 id="_2">拟合加性模型</h2>
<p>在这一节我们讨论拟合加性模型和它们的一般形式的标准算法。组件是用一种灵活的方式拟合非线性影响的散点图光滑器。具体地，我们将在第五章中讨论的三次光滑样条作为我们的散点图光滑器。</p>
<p>加性模型有如下形式
<script type="math/tex; mode=display">
Y=\alpha + \sum_{j=1}^pf_j(X_j)+\varepsilon\qquad (9.6)
</script>
其中误差项$\varepsilon$均值为0.给定观测值$x_i,y_i$,可以确定处该问题的类似5.4节中讨论的惩罚平方和（5.9）的准则，
<script type="math/tex; mode=display">
\mathrm{PRSS}(\alpha,f_1,f_2,\ldots,f_p)=\sum\limits_{i=1}^N(y_i-\alpha-\sum\limits_{j=1}^pf_j(x_{ij}))^2+\sum\limits_{j=1}^p\lambda_j\int f_j''(t_j)^2dt_j\quad (9.7)
</script>
其中$\lambda_j\ge 0$是调整参数，可以证明（9.7）的最小值是可加三次样条模型；每个函数$f_j$是一个关于组分$X_j$的三次样条，结点在每个唯一的$x_{ij},i=1,\ldots,N$值处.然而，没有对模型有进一步的约束，解不是唯一的。常数$\alpha$不是唯一的，因为我们可以对每个函数$f_j$进行加减任意常数，然后因此调整$\alpha$.标准的规定是假设$\sum_1^Nf_j(x_{ij})=0,\forall j$——这些函数在数据上均值为0.可以很简单地证明得到在这种情形下$\hat\alpha=\mathrm {ave}(y_i)$.如果再加上这条约束，输入矩阵（第$ij$位置值为$x_{ij}$）有列满秩，则（9.7）是严格凸准则并且最小化是唯一的。如果矩阵是奇异的，则组分$f_j$的线性部分不能被唯一确定（尽管非线性部分可以！）（Buja等人1989）</p>
<p>进一步，寻找解存在一个简单的迭代过程。令$\hat\alpha=\mathrm {ave}(y_i)$,而且不变。我们对目标${y_i-\hat\alpha-\sum_{k\neq j}\hat f_k(x_{ik})}<em>1^N$应用三次光滑样条$\cal S_j$作为$x</em>{ij}$的函数得到新估计$\hat f_j$。对每个预报变量依次这样处理，当计算$y_i-\hat\alpha-\sum_{k\neq j}\hat f_k(x_{ik})$时使用其它函数的当前估计$\hat f_k$。这个过程直到估计$\hat f_j$稳定。这个过程被称作“backfitting”（算法9.1中给出了详细细节），而且最后的拟合与对线性模型的多项式回归是相似的。</p>
<p><img alt="" src="../../img/09/alg9.1.png" /></p>
<p>原则上，算法9.1中的第(2)步不是必需的，因为光滑样条对0均值响应变量拟合均值为0（练习9.1）。实际中，机器舍入误差会导致下降，所以建议进行调整。</p>
<p>同样的算法可以通过确定合适的光滑算子$\cal S_j$来以同样的方式适应其他的拟合方法。</p>
<ul>
<li>其它的单变量回归光滑器比如局部多项式回归和核方法</li>
<li>线性回归算子产生多项式拟合，分段常值拟合，参数化样条拟合，序列和傅里叶拟合。</li>
<li>更加复杂的算子比如对于二阶或者高阶交互项或者对于季节影响的周期光滑器。</li>
</ul>
<p>如果我们仅仅在训练集点上考虑光滑器算子$\cal S_j$，这可以用$N\times N$的算子矩阵$\mathbf S_j$来表示（见5.4.1节）。则第$j$项的自由度（近似）是$\mathrm {df}_j=\mathrm{trace}[\mathbf S_j]-1$,这与第5和第6章中讨论的光滑器的自由度是类似的。</p>
<p>对于一个大类别的线性光滑器$\mathbf S_j$，backfitting等价于求解确定线性系统的Gauss-Seidel算法。细节在练习9.2中给出。</p>
<p>对于逻辑斯蒂回归和其他广义加性模型，合适的准则是惩罚的对数似然。为了最大化它，backfitting过程与概率最大化一起起作用。在广义线性模型中最大化对数似然的Newton-Raphson方法可以重新改造成一个IRILS（迭代重加权最小二乘）算法。这涉及在协变量上对工作中的响应变量重复进行加权线性回归；每个回归得到一个新的参数估计，反过来又给了新的工作相应变量和系数，而且这一过程迭代进行（见4.4.1节）。在广义加性模型中，加权线性回归简单地用加权backfitting算法来替换。我们将在下面讨论逻辑斯蒂回归时该算法的细节，更一般的讨论在第6章的Hastie和Tibshirani(1990).</p>
<h2 id="_3">例子：加性逻辑斯蒂回归</h2>
<p>或许在医学研究中应用最广的模型是对二值数据的逻辑斯蒂回归模型。在这个模型中，输出$Y$可以编码成0或1，其中1代表事件发生（比如死亡，疾病复发），0代表没有事件发生。我们希望建立$Pr(Y=1\mid X)$的模型，其中$Pr(Y=1\mid X)$是给定预测因子$X^T=(X_1,\ldots,X_p)$后事件发生的概率。目标通常是确定预测因子的作用，而不是对新个体进行分类。逻辑斯蒂回归也应用到当对估计类别比例感兴趣的情况下，比如risk screening。除了医学上的应用，信用风险screening也是一个受欢迎的应用方面。</p>
<p>广义加性模型有如下形式
<script type="math/tex; mode=display">
\mathrm{log}\frac{Pr(Y=1\mid X)}{Pr(Y=0\mid X)}=\alpha+f_1(X_1)+\cdots+f_p(X_p)\qquad (9.8)
</script>
函数$f_1,f_2,\ldots,f_p$是通过在Newton-Raphson过程中运用backfitting算法估计得到的，算法9.2中显示了具体过程。</p>
<p><img alt="" src="../../img/09/alg9.2.png" /></p>
<p>加性模型在算法9.2中的第（2）步拟合需要一个带权重的散点图光滑器。许多光滑过程可以接受观测值权重（练习5.12）；更多细节参见第三章Hastie和Tibshirani（1990）的工作。</p>
<p>加性逻辑斯蒂回归模型可以进一步推广为解决超过两个类别的情形，通过采用在4.4节中列出的多维逻辑斯蒂公式。尽管这个形式是（9.8）式的直接展开，拟合这些模型的算法更加复杂。更多细节参加Yee和Wild(1996)，并且VGAM软件可以从下面网站中得到</p>
<p><a href="http://www.stat.auckland.ac.nz/∼yee"></a></p>
<h2 id="_4">例子：预测垃圾邮件</h2>
<p>我们对第一章的spam数据应用广义加性模型。数据包含4601条电子邮件信息，在一项研究中去扫描邮件来找出“spam”（比如，垃圾邮件）。数据可以在<a href="../ftp.ics.uci.edu">ftp.ics.uci.edu</a>上获得，而且接受California的Palo Alto的Hewlett-Packard实验室中George Forman的捐赠。</p>
<p>响应变量是二值数据，值为email或者spam，在下面描述了57个预报变量。</p>
<ul>
<li>48个定量预报变量——邮件中匹配给定单词的单词比例。例子比如说有business，address，internet，free和george。这些想法是因为对不同用户这些可以定做的。（？？？？）</li>
<li>6个定量预报变量——邮件中匹配给定字符的字符比例。字符为ch;，ch(;，ch[，ch!，ch$，和ch#.</li>
<li>未间断的大写字符序列的平均长度：CAPAVE</li>
<li>未间断的大写字符序列的最长长度：CAPMAX</li>
<li>未间断的大写字符序列的总长度：CAPTOT</li>
</ul>
<p>我们将spam编码成1，email编码成0.随机选取大小为1536的测试集，剩下的3065个测试集作为测试集。一个广义加性模型通过对每个预报变量用四个名义自由度的三次光滑样条。这意味着对于每个预报变量$X_j$，选择光滑样条的参数$\lambda_j$使得$\mathrm {trace}[\mathbf S_j(\lambda_j)]-1=4$,其中$\mathbf S_j(\lambda)$是使用观测数据$x_{ij},i=1,\ldots,N$构造处的光滑样条算子矩阵。这是在这样一个复杂模型中确定光滑数量的方便方式。</p>
<p>大多数的spam预报变量服从一个非常长的长尾分布。在拟合GAM模型之前，对每个变量进行对数变换（实际上是$\mathrm {log}(x+0.1)$）,但是在图9.1画出的是关于原始变量的函数。</p>
<p><img alt="" src="../../img/09/fig9.1.png" /></p>
<blockquote>
<p>图9.1. 垃圾分析：对于显著性预报变量的估计函数。在每张图的横轴的须状图（rug plot）表示对应的预报变量。对于许多预报变量非线性是在0处的不连续性导致的。</p>
</blockquote>
<p>表9.1显示了测试误差率；总体误差率为5.3%。为了对比，线性逻辑斯蒂回归有7.6%的测试误差。表9.2显示了在可加性模型中显著性强的预报变量。</p>
<p><img alt="" src="../../img/09/tab9.1.png" /></p>
<blockquote>
<p>表9.1. 对垃圾训练数据的加性逻辑斯蒂回归模型拟合的混淆矩阵。整体测试误差率为5.5%.</p>
</blockquote>
<p><img alt="" src="../../img/09/tab9.2.png" /></p>
<blockquote>
<p>表9.2. 对spam训练数据进行加性模型拟合的显著性预报变量。系数和它们的标准误差以及Z得分来表示$\hat f_j$的线性部分。非线性p值是对$\hat f_j$非线性的检验。</p>
</blockquote>
<p>为了解释的方便，表9.2中有每个变量分解成线性组分和剩余非线性组分的贡献。靠前的预测变量与spam正相关，而最后的预测变量负相关。线性组分是在预报变量上对拟合曲线的加权最小二乘线性拟合，而非线性部分是剩余部分。估计函数的线性部分是由系数、标准误差和$Z$得分来总结（表示）；后者（指Z得分）是系数除以它的标准误差，而且当它超过合适的标准正态分布的分位数认为是显著的。标签为nonlinear P-value的列是对估计函数非线性部分的测试。然而，注意到，每个预报变量的影响是根据其他变量的整体影响来调整的，而不仅仅是它们的线性部分。表中显示的预报变量通过在$p=0.01$水平下（双边）进行至少一个检验（线性或者非线性）来判断是否显著的。</p>
<p>图9.1 显示了在表9.2中出现的显著预测变量的估计函数。许多非线性影响表明在0处的强不连续性。举个例子，当george的频率从0增长，spam的概率显著下降，但是此后没有太大改变。这表明或许会用一个表示计数为0的指示变量来替换每个频率预测变量，这样回到线性逻辑斯蒂回归。这给出7.4%的测试误差；包括频率的线性影响将测试误差降低到6.6%。看起来在加性模型中的非线性有着额外的预测力量。</p>
<p>将真正的email分类成spam是很严重的，因为好邮件会被过滤掉而不能到达用户手中。我们可以通过改变损失来平衡类别误差率（见2.4节）。如果我们对将真实的类别0预测成类别1赋予损失$L_{01}$,$L_{10}$为将真实的类别1预测成类别0的损失，于是如果概率大于$L_{01}/(L_{01}+L_{10})$则估计的贝叶斯准则预测为类别1.举个例子，如果我们取$L_{01}=10,L_{10}=1$则（真实的）类别0和类别1误差率变成0.8%和8.7%.</p>
<p>更ambitiously,我们通过对类别0的观测赋予权重$L_{01}$，对类别1的观测赋予权重$L_{10}$使得模型更好地对类别0中的数据进行拟合。像上面一样，我们接着运用贝叶斯准则来预测。在类别0和类别1中误差率分别为1.2%和8.0%.我们在基于树的模型中讨论损失不相等的问题。</p>
<p>拟合加性模型之后，应该检查一下加入交互关系之后是否显著性提高拟合。这可以通过插入一些或全部的显著性输入来“手动”完成，或者通过MARS过程来自动完成。（见9.4节）</p>
<p>这个例子以一种自动的方式来使用加性模型。作为一个数据分析工具，加性模型经常以一种更交互的方式来使用，通过添加或者删除项来确定它们的影响。通过校准关于$df_j$的光滑数量，可以在线性模型（$df_j=1$）和部分线性模型中移动，其中一些项更加灵活地建模。更多细节见Hastie和Tibshirani(1990)的工作。</p>
<h2 id="_5">总结</h2>
<p>加性模型提供一个有用的线性模型拓展，使得不仅保留着大部分的可解释性，也更加灵活。在线性模型中建模和推断熟悉的工具对于加性模型也是适用的，见表9.2的例子。拟合这些模型的backfitting过程是简单而有模式的，允许对于每个输入变量去选择合适的拟合方法。结果在统计领域它们越来越被广泛地应用。</p>
<p>然而加性模型对于大的数据挖掘的应用是有限制的。backfitting算法拟合所有的预测变量，而大部分的预测变量是不可行的也不是必需的。BRUTO过程（Hastie和Tibshirani,1990，第9章）结合backfitting和输入选择，但是不是为了大规模的数据挖掘的问题。最近也有用lasso型惩罚来估计稀疏加性模型的工作，举个例子，Lin和Zhang（2006）提出的COSSO过程，以及Ravikumar等人（2008）提出的SpAM。对于大型问题，向前逐步方法（比如第10章的boosting）更加地有效，而且运行交叉项包含进模型中。</p>

<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
/*
var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//weiya.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//weiya.disqus.com/count.js" async></script></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright &copy; 2016-2017 weiya</center>
            
            <center>Powered by <a href="http://www.mkdocs.org/">MkDocs</a> and <a href="http://bootswatch.com/yeti/">Yeti</a></center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
	<script src="../../js/jquery.dropdown.js"></script>
        <script src="../../js/MathJax/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script src="../../js/mymathjax.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">搜索</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            请在下面输入你要搜索的文本（仅支持英文）：
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="搜索..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>