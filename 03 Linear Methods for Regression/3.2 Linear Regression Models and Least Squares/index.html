<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="The Elements of Statistical Learning(ESL) 的中文笔记">
        
        <link rel="canonical" href="https://szcf-weiya.github.io/ESL-CN/03 Linear Methods for Regression/3.2 Linear Regression Models and Least Squares/">
	<link rel="shortcut icon" href="../../img/favicon.ico">

	<title>3.2 线性回归模型和最小二乘法 - ESL CN</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/newsprint.css" rel="stylesheet">
        <link href="../../css/admonition_fix.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-85046550-1', 'auto');
          ga('send', 'pageview');

        </script>
        <!--mathjax-->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          tex2jax: {
          	inlineMath: [['$','$'], ['\\(','\\)']],
          	processEscapes:true
          },
          TeX: {
          	entensions: ["color.js"]
          }
          });
        </script>
        <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.2-beta.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
<!--
	<style>
	  .dropdown-menu {
    max-height: 500px;
    overflow-y: auto;
    overflow-x: auto;
}
	</style>
-->
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="">ESL CN</a>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">主页</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">上篇 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">序言</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../Preface/2016-07-20-Preface-to-the-Second-Edition/">第二版序言</a>
</li>

        
            
<li >
    <a href="../../Preface/2016-07-21-Preface-to-the-First-Edition/">第一版序言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">1 简介</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../01 Introduction/2016-07-26-Chapter-1-Introduction/">1.1 导言</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">2 监督学习概要</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.1 Introduction/">2.1 导言</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.2 Variable Types and Terminology/">2.2 变量类型和术语</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.3 Two Simple Approaches to Prediction/">2.3 两种预测的简单方法</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.4 Statistical Decision Theory/">2.4 统计判别理论</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.5 Local Methods in High Dimensions/">2.5 高维问题的局部方法</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.6 Statistical Models, Supervised Learning and Function Approximation/">2.6 统计模型，监督学习和函数逼近</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.7 Structured Regression Models/">2.7 结构化的回归模型</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.8 Classes of Restricted Estimators/">2.8 限制性估计的类别</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/2.9 Model Selection and the Bias-Variance Tradeoff/">2.9 模型选择和偏差-方差的权衡</a>
</li>

        
            
<li >
    <a href="../../02 Overview of Supervised Learning/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">3 回归的线性方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../3.1 Introduction/">3.1 导言</a>
</li>

        
            
<li class="active">
    <a href="./">3.2 线性回归模型和最小二乘法</a>
</li>

        
            
<li >
    <a href="../3.3 Subset Selection/">3.3 子集的选择</a>
</li>

        
            
<li >
    <a href="../3.4 Shrinkage Methods/">3.4 收缩的方法</a>
</li>

        
            
<li >
    <a href="../3.5 Methods Using Derived Input Directions/">3.5 运用派生输入方向的方法</a>
</li>

        
            
<li >
    <a href="../3.6 A Comparison of the Selection and Shrinkage Methods/">3.6 选择和收缩方法的比较</a>
</li>

        
            
<li >
    <a href="../3.7 Multiple Outcome Shrinkage and Selection/">3.7 多重输出的收缩和选择</a>
</li>

        
            
<li >
    <a href="../3.8 More on the Lasso and Related Path Algorithms/">3.8 Lasso和相关路径算法的补充</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">4 分类的线性方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.1 Introduction/">4.1 导言</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.2 Linear Regression of an Indicator Matrix/">4.2 指示矩阵的线性回归</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.3 Linear Discriminant Analysis/">4.3 线性判别分析</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.4 Logistic Regression/">4.4 逻辑斯蒂回归</a>
</li>

        
            
<li >
    <a href="../../04 Linear Methods for Classification/4.5 Separating Hyperplanes/">4.5 分离超平面</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">5 基展开和正规化</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.1 Introduction/">5.1 导言</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.2 Piecewise Polynomials and Splines/">5.2 分段多项式和样条</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.3 Filtering and Feature Extraction/">5.3 滤波和特征提取</a>
</li>

        
            
<li >
    <a href="../../05 Basis Expansions and Regularization/5.4 Smoothing Splines/">5.4 光滑样条</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">6 核光滑方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.0 Introduction/">6.0 导言</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.1 One-Dimensional Kernel Smoothers/">6.1 一维核光滑器</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.2 Selecting the Width of the Kernel/">6.2 选择核的宽度</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.3 Local Regression in R^p/">6.3 $R^p$中的局部回归</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.4 Structured Local Regression Models in R^p/">6.4 $R^p$中的结构化局部回归模型</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.5 Local Likelihood and Other Models/">6.5 局部似然和其他模型</a>
</li>

        
            
<li >
    <a href="../../06 Kernel Smoothing Methods/6.6 Kernel Density Estimation and Classification/">6.6 核密度估计和分类</a>
</li>

        
    </ul>
  </li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">中篇 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">7 模型评估及选择</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.1 Introduction/">7.1 导言</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.2 Bias, Variance and Model Complexity/">7.2 偏差，方差和模型复杂度</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.3 The Bias-Variance Decomposition/">7.3 偏差-方差分解</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.4 Optimism of the Training Error Rate/">7.4 测试误差率的乐观</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.5 Estimates of In-Sample Prediction Error/">7.5 样本内预测误差的估计</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.6 The Effective Number of Parameters/">7.6 参数的有效个数</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.7 The Bayesian Approach and BIC/">7.7 贝叶斯方法和BIC</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.8 Minimum Description Length/">7.8 最小描述长度</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.9 Vapnik-Chervonenkis Dimension/">7.9 VC维</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.10 Cross-Validation/">7.10 交叉验证</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.11 Bootstrap Methods/">7.11 自助法</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/7.12 Conditional or Expected Test Error/">7.12 条件测试误差或期望测试误差</a>
</li>

        
            
<li >
    <a href="../../07 Model Assessment and Selection/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">8 模型推断和平均</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.1 Introduction/">8.1 导言</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.2 The Bootstrap and Maximum Likelihood Methods/">8.2 自助法和最大似然法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.3 Bayesian Methods/">8.3 贝叶斯方法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.4 Relationship Between the Bootstrap and Bayesian Inference/">8.4 自助法和贝叶斯推断之间的关系</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.5 The EM Algorithm/">8.5 EM算法</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.6 MCMC for Sampling from the Posterior/">8.6 MCMC向后采样</a>
</li>

        
            
<li >
    <a href="../../08 Model Inference and Averaging/8.7 Bagging/">8.7 袋装法</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">9 增广模型，树，以及相关方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.0 Introduction/">9.0 导言</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.1 Generalized Additive Models/">9.1 广义加性模型</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.2 Tree-Based Methods(CART)/">9.2 基于树的方法</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.3 PRIM(Bump Hunting)/">9.3 耐心规则归纳法</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.4 MARS(Multivariate Adaptive Regression Splines)/">9.4 多变量自适应回归样条</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.5 Hierarchical Mixtures of Experts/">9.5 专家的系统混合</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.6 Missing Data/">9.6 缺失数据</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/9.7 Computational Considerations/">9.7 计算上的考虑</a>
</li>

        
            
<li >
    <a href="../../09 Additive Models, Trees, and Related Methods/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">10 增强和加性树</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.1 Boosting Methods/">10.1 增强方法</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.2 Boosting Fits an Additive Model/">10.2 boosting拟合可加模型</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.3 Forward Stagewise Additive Modeling/">10.3 向前逐步加性建模</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.4 Exponential Loss and AdaBoost/">10.4 指数损失和AdaBoost</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.5 Why Exponential Loss/">10.5 为什么是指数损失</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.6 Loss Functions and Robustness/">10.6 损失函数和鲁棒性</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.7 Off-the-Shelf Procedures for Data Mining/">10.7 数据挖掘的现货方法</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.8 Spam Data/">10.8 垃圾邮件的例子</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.9 Boosting Trees/">10.9 boosting树</a>
</li>

        
            
<li >
    <a href="../../10 Boosting and Additive Trees/10.10 Numerical Optimization via Gradient Boosting/">10.10 利用梯度boosting的数值优化</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">11 神经网络</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../11 Neural Networks/11.1 Introduction/">11.1 导言</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.2 Projection Pursuit Regression/">11.2 投影寻踪回归</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.3 Neural Networks/">11.3 神经网络</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.4 Fitting Neural Networks/">11.4 拟合神经网络</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.5 Some Issues in Training Neural Networks/">11.5 训练神经网络的一些问题</a>
</li>

        
            
<li >
    <a href="../../11 Neural Networks/11.6 Example of Simulated Data/">11.6 模拟数据的例子</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">12 支持向量机和灵活的判别方法</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../12 Support Vector Machines and Flexible Discriminants/12.1 Introduction/">12.1 导言</a>
</li>

        
            
<li >
    <a href="../../12 Support Vector Machines and Flexible Discriminants/12.2 The Support Vector Classifier/">12.2 支持向量分类器</a>
</li>

        
    </ul>
  </li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">下篇 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">13 原型方法和最近邻</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.1 Introduction/">13.1 导言</a>
</li>

        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.2 Prototype Methods/">13.2 原型方法</a>
</li>

        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.3 k-Nearest-Neighbor Classifiers/">13.3 k最近邻分类器</a>
</li>

        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.4 Adaptive Nearest-Neighbor Methods/">13.4 自适应的最近邻方法</a>
</li>

        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/13.5 Computational Considerations/">13.5 计算上的考虑</a>
</li>

        
            
<li >
    <a href="../../13 Prototype Methods and Nearest-Neighbors/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">14 非监督学习</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../14 Unsupervised Learning/14.1 Introduction/">14.1 导言</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.2 Association Rules/">14.2 关联规则</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.3 Cluster Analysis/">14.3 聚类分析</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.4 Self-Organizing Maps/">14.4 自组织图</a>
</li>

        
            
<li >
    <a href="../../14 Unsupervised Learning/14.4 Self-Organizing Maps/">14.5 主成分，主曲线以及主曲面</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">15 随机森林</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../15 Random Forests/15.1 Introduction/">15.1 导言</a>
</li>

        
            
<li >
    <a href="../../15 Random Forests/15.2 Definition of Random Forests/">15.2 随机森林的定义</a>
</li>

        
            
<li >
    <a href="../../15 Random Forests/15.3 Details of Random Forests/">15.3 随机森林的细节</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">16 增强学习</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../16 Ensemble Learning/16.1 Introduction/">16.1 导言</a>
</li>

        
            
<li >
    <a href="../../16 Ensemble Learning/16.2 Boosting and Regularization Paths/">16.2 增强和正则路径</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">17 无向图模型</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.1 Introduction/">17.1 导言</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.2 Markov Graphs and Their Properties/">17.2 马尔科夫图及其性质</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.3 Undirected Graphical Models for Continuous Variables/">17.3 连续变量的无向图模型</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/17.4 Undirected Graphical Models for Discrete Variables/">17.4 离散变量的无向图模型</a>
</li>

        
            
<li >
    <a href="../../17 Undirected Graphical Models/Bibliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu scrollable-menu">
    <a tabindex="-1" class="nav-title">18 高维问题</a>
    <ul class="dropdown-menu scrollable-menu">
        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.1 When p is Much Bigger than N/">18.1 当p大于N</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.2 Diagonal Linear Discriminant Analysis and Nearest Shrunken Centroids/">18.2 对角线性判别分析和最近收缩重心</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.3 Linear Classifiers with Quadratic Regularization/">18.3 二次正则的线性分类器</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.4 Linear Classifiers with L1 Regularization/">18.4 一次正则的线性分类器</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.5 Classification When Features are Unavailable/">18.5 当特征不可用时的分类</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.6 High-Dimensional Regression/">18.6 有监督的主成分</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/18.7 Feature Assessment and the Multiple-Testing Problem/">18.7 特征评估和多重检验问题</a>
</li>

        
            
<li >
    <a href="../../18 High-Dimensional Problems/Bioliographic Notes/">文献笔记</a>
</li>

        
    </ul>
  </li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
              <!--
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> 搜索
                    </a>
                </li>
              -->
                <li>
                  <a href="https://szcf-weiya.github.io/ESL-CN/03 Linear Methods for Regression/3.2 Linear Regression Models and Least Squares/#disqus_thread">0 Comments</a>
                </li>
                <li >
                    <a rel="next" href="../3.1 Introduction/">
                        <i class="fa fa-arrow-left"></i> 上一节
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../3.3 Subset Selection/">
                        下一节 <i class="fa fa-arrow-right"></i>
                    </a>
                </li>


                
                <!--
                <li>
                    <a href="https://github.com/szcf-weiya">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
              -->
                <li>
                  <a href="https://github.com/szcf-weiya"><i class="fa fa-github" aria-hidden="true"></i> GitHub</a>
                </li>
                <li>
                  <a href="https://stats.hohoweiya.xyz"><i class="fa fa-rss" aria-hidden="true"></i> 英文博客</a>
                </li>
                <li>
                  <a href="https://blog.hohoweiya.xyz"><i class="fa fa-pencil" aria-hidden="true"></i> 中文随笔</a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1">线性回归模型和最小二乘法</a></li>
        
            <li><a href="#_2">例子：前列腺癌</a></li>
        
            <li><a href="#guass-markov">Guass-Markov定理</a></li>
        
            <li><a href="#_3">从简单单变量回归到多重回归</a></li>
        
            <li><a href="#_4">多重输出</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="_1">线性回归模型和最小二乘法</h1>
<table>
<thead>
<tr>
<th>原文</th>
<th><a href="../../book/The Elements of Statistical Learning.pdf">The Elements of Statistical Learning</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>翻译</td>
<td>szcf-weiya</td>
</tr>
<tr>
<td>时间</td>
<td>2016-08-03</td>
</tr>
</tbody>
</table>
<p>正如第二章介绍的那样，我们有输入向量$X^T=(X_1,X_2,\ldots,X_p)$,而且想要预测实数值输出$Y$。线性模型有如下形式
<script type="math/tex; mode=display">
f(X)=\beta_0+\sum\limits_{j=1}^pX_j\beta_j \qquad (3.1)
</script>
</p>
<p>线性模型要么假设回归函数$E(Y\mid X)$是线性的，要么假设线性模型是一个合理的近似。这里$\beta_j$是位置的参数或系数，变量$X_j$可以有下列不同的来源：</p>
<ul>
<li>定量的输入</li>
<li>定量输入的变换，比如对数，平方根或者平方</li>
<li>基函数展开，比如$X_2=X_1^2,X_3=X_1^3$,得到多项式表示</li>
<li>定性输入变量水平的数值或“虚拟”编码。举个例子，如果$G$是5个水平的因子输入，我们可能构造$X_j,j=1,\ldots,5$使得$X_j=I(G=j)$。借助于一系列独立于水平的常数，整个$X_j$用来表示$G$的效应。因为在$\sum_{j=1}^5X_j\beta_j$中，其中一个$X_j$的系数为1，其它的都是0。</li>
<li>变量之间的相交，举个例子，$X_3=X_1\cdot X_2$
  无论$X_j$是哪个来源，用参数表示的模型是线性的。</li>
</ul>
<p>一般地，我们有一系列用来估计参数$\beta$的训练数据$(x_1,y_1),\ldots,(x_N,y_N)$。每个$x_i=(x_{i1},x_{i2},\ldots,x_{ip})^T$是第$i$种情形的特征衡量的向量。最受欢迎的估计方法是最小二乘(<em>least squares</em>)，我们选择参数$\beta=(\beta_0,\beta_1,\ldots,\beta_p)^T$使残差平方和最小
<script type="math/tex; mode=display">
\begin{align}
RSS(\beta)&=\sum\limits_{i=1}^N(y_i-f(x_i))^2\\
&=\sum\limits_{i=1}^N(y_i-\beta_0-\sum\limits_{j=1}^px_{ij}\beta_j)^2\qquad (3.2)
\end{align}
</script>
</p>
<p>从统计学的观点来看，如果训练观测值$(x_i,y_i)$为从总体独立随机抽取的则该标准是合理的。即使$x_i$&rsquo;s不是随机选取的，如果在给定输入$x_i$的条件下$y_i$条件独立。图3.1图示了在充满实数对$(X,Y)$的$R^{p+1}$维空间的最小二乘拟合的几何意义。注意到(3.2)对模型(3.1)的有效性没有作假设，根据数据可以简单地找到最好的线性拟合。无论数据是怎样产生的，最小二乘拟合直观上看是满意的，这个准则衡量了拟合误差的平均。</p>
<p><img alt="" src="../../img/03/fig3.1.png" /></p>
<p>图3.1 $X\in R^2$中的最小二乘拟合。我们寻找关于$X$并且使$Y$的残差最小的线性函数。</p>
<p>我们怎样最小化(3.2)？记$\mathbf{X}$为$N\times (p+1)$的矩阵，矩阵每一行为一个输入向量(在第一个位置为1)，类似地令$\mathbf{y}$为训练集里的$N$个输出向量。然后我们可以将残差平方和写成如下形式
<script type="math/tex; mode=display">
RSS(\beta)=(\mathbf{y}-\mathbf{X}\beta)^T(\mathbf{y}-\mathbf{X}\beta)\qquad (3.3)
</script>
</p>
<p>这是含$p+1$个参数的二次函数。关于$\beta$求导有
<script type="math/tex; mode=display">
\begin{array}{ll}
\dfrac{\partial RSS}{\partial \beta}&=-2\mathbf{X}^T(\mathbf{y}-\mathbf{X}\beta)\\
\dfrac{\partial^2 RSS}{\partial \beta\partial \beta^T}&=2\mathbf{X}^T\mathbf{X}
\end{array}
\qquad (3.4)
</script>
</p>
<p>假设$\mathbf{X}$有列满秩，因此$\mathbf{X}^T\mathbf{X}$是正定的，我们令一阶微分为0，即
<script type="math/tex; mode=display">
\mathbf{X}^T(\mathbf{y}-\mathbf{X}\beta)=0\qquad (3.5)
</script>
</p>
<p>得到唯一解
<script type="math/tex; mode=display">
\hat{\beta}=(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}\qquad (3.6)
</script>
</p>
<p><img alt="" src="../../img/03/fig3.2.png" /></p>
<p>图3.2 含两个预测的最小二乘回归的$N$维几何图形。输出向量$\mathbf{y}$正交投影在输入向量$\mathbf{x}_1$和$\mathbf{x}_2$张成的超空间中。投影向量$\hat{\mathbf{y}}$表示最小二乘法的预测值</p>
<p>在输入向量$x_0$下的预测值由$\hat{f}(x_0)=(1:x_0)^T\hat{\beta}$;在训练输入下的拟合值为
<script type="math/tex; mode=display">
\hat{y}=\mathbf{X}\hat{\beta}=\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}\qquad (3.7)
</script>
</p>
<p>其中，$\hat y_i=\hat f(x_i)$。在式(3.7)中出现的矩阵$\mathbf{H=X(X^TX)^{-1}X^T}$</p>
<p>图3.2展示了在$R^N$中最小二乘估计的的不同几何表示。我们记$\mathbf{X}$的列向量为$\mathbf(x_0,x_1,\ldots,x_p)$,其中$x_0 \equiv 1$。下文中第一列认为是跟其它的是一样的。这些向量张成了$R^N$的子空间，也被称作$\mathbf{X}$的列空间。我们通过选择$\hat{\beta}$来最小化$RSS(\beta)=\lVert(\mathbf{y}-\mathbf{X}\beta)\rVert^2$，则残差向量$\mathbf{y-\hat{y}}$正交于子空间。(3.5)式描述了这种正交，然后估计的结果$\hat{y}$因此是$\mathbf{y}$在子空间的正交投影。帽子矩阵$\mathbf{H}$计算正交投影，因此也被称作投影矩阵。</p>
<p>可能会出现$\mathbf{X}$的列不是线性独立的，则$\mathbf{X}$不是满秩的。举个例子，如果两个输入是完全相关的，（比如，$x_2=3x_1$）。则矩阵$\mathbf{X^TX}$是奇异的，并且最小二乘的系数$\hat{\beta}$不是唯一的。然而，拟合值$\mathbf{\hat{y}}=\mathbf{X}\hat{\beta}$仍然是$\mathbf{y}$在列空间$\mathbf{X}$的投影；对于$\mathbf{X}$的列向量有多种方式表达这种投射。当一个或多个定性输入用一种冗余的方式编码时经常出现非满秩的情形。通过重编码或去除$\mathbf{X}$中冗余的列这些自然的方式去分解不是唯一的表达式。大多数回归软件包监测这些冗余并且用一些策略自动实现去除。秩缺失在信号和图像分析中经常发生，输入的个数$p$可以超出训练的情形$N$。在这种情形下，这种特征经常通过滤波或由正则化控制的拟合来降低。（5.2.3节和第18章）</p>
<p>截至目前我们已经对数据的真实分布做了很少的假设。为了约束$\hat{\beta}$的取样特点，我们现在假设观测值$y_i$不相关，且有固定的方差$\sigma^2$，并且$x_i$是给定的（非随机）。最小二乘法的参数估计的方差-协方差阵可以很容易从式(3.6)得到
<script type="math/tex; mode=display">
Var(\hat{\beta})=(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\qquad (3.8)
</script>
</p>
<p>经常通过下式来估计方差$\sigma^2$
<script type="math/tex; mode=display">
\hat{\sigma}^2=\frac{1}{N-p-1}\sum\limits_{i=1}^N(y_i-\hat{y}_i)^2
</script>
</p>
<p>分母是$N-p-1$而不是$N$,因为此时的分母使得$\hat{\sigma}^2$为无偏估计:$E(\hat{\sigma}^2)=\sigma^2$</p>
<p>为了对参数和模型进行推断，需要一些额外的假设。我们现在假设式$(3.1)$是均值的正确模型；则$Y$的条件期望关于$X_1,X_2,\ldots,X_p$是线性的。我们也假设$Y$与其期望的偏差是可加的和高斯的。因此
<script type="math/tex; mode=display">
\begin{align}
Y&=E(Y\mid X_1,\ldots,X_p)+\varepsilon\\
&=\beta_0+\sum\limits_{j=1}^pX_j\beta_j+\varepsilon\qquad (3.9)
\end{align}
</script>
</p>
<p>其中误差$\epsilon$是期望值为0方差为$\sigma^2$的高斯随机变量,记作$\varepsilon\sim N(0,\sigma^2)$</p>
<p>由式(3.9),可以很简单地证明
<script type="math/tex; mode=display">
\hat{\beta}\sim N(\beta,(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2) \qquad (3.10)
</script>
</p>
<p>这是一个有上述均值向量和方差-协方差矩阵的多变量正态分布。同时有
<script type="math/tex; mode=display">
(N-p-1)\hat \sigma^2\sim \sigma^2\chi^2_{N-p-1}\qquad (3.11)
</script>
</p>
<p>是一个自由度为$N-p-1$的卡方分布。另外，$\hat{\beta}$和$\hat\sigma^2$是统计独立的。我们利用这些分布性质得到假设检验以及对于参数$\beta_j$的置信区间</p>
<p><img alt="" src="../../img/03/fig3.3.png" /></p>
<blockquote>
<p>图3.3 $t_{30}$,$t_{100}$以及标准正态三种分布的尾概率$Pr(|Z|&gt;z)$。图中显示了在$p=0.05$和0.01水平下检验显著性的合适分位数。当$N$大于100时$t$分布与标准正态分布之间的差异很小。</p>
</blockquote>
<p>为了检验系数$\beta_j$的这一假设，我们构造标准化因数或者Z-分数。
<script type="math/tex; mode=display">
z_j=\dfrac{\hat{\beta}_j}{\hat{\sigma}\sqrt{v_j}}\qquad  (3.12)
</script>
</p>
<p>其中$v_j$是$(\mathbf{X}^T\mathbf{X})^{-1}$的第$j$个对角元。零假设为$\beta_j=0$,$z_j$分布为$t_{N-p-1}$(自由度为$N-p-1$的$t$分布)，因此当$z_j$的绝对值较大时会拒绝零假设。如果用已知的$\sigma$值替换$\hat{\sigma}$，则$z_j$服从标准正态分布。$t$分布和标准正态分布在尾概率之间的差异随着样本规模增大可以忽略，因此我们一般使用正态的分位数（图3.3）。</p>
<p>我们经常需要同时检验系数集体的显著性。举个例子，检验有$k$个水平的分类变量是否要从模型中排除，我们需要检验用来表示水平的虚拟变量的系数是否可以全部设定为0。这里我们利用$F$统计量</p>
<p>
<script type="math/tex; mode=display">
F=\dfrac{(RSS_0-RSS_1)/(p_1-p_0)}{RSS_1/(N-p_1-1)}\qquad (3.13)
</script>
</p>
<p>其中$RSS_1$是有$p_1+1$个参数的大模型的最小二乘法拟合的残差平方和，$RSS_0$是有$p_0+1$参数的小模型的最小二乘法拟合的残差平方和，有$p_1-p_0$个参数限制为0.$F$统计量衡量了在大模型中每个增加的系数对残差平方和的改变，而且用$\sigma^2$的估计值进行标准化。在高斯分布以及小模型的零假设为正确的情况下，$F$统计量服从$F_{p_1-p_0,N-p_1-1}$分布。可以证明（习题3.1）（3.12）式中的$z_j$等于从模型中去除单系数$\beta_j$的$F$统计量，当$N$足够大时，$F_{p_1-p_0,N-p_1-1}$近似$\chi^2_{p_1-p_0}$</p>
<p>类似地，我们可以分离式（3.10）中的$\beta_j$得到$\beta_j$的置信水平为$1-2\alpha$的置信区间</p>
<p>
<script type="math/tex; mode=display">
(\hat{\beta}_j-z^{1-\alpha}v_j^{1/2}\hat{\sigma},\hat{\beta}_j+z^{1-\alpha}v_j^{1/2}\hat{\sigma})\qquad (3.14)
</script>
</p>
<p>这里，$z^{1-\alpha}$是正态分布的$1-\alpha$分位数。
<script type="math/tex; mode=display">
\begin{align}
z^{1-0.025}&=1.96,\\
z^{1-0.05}&=1.645,etc.
\end{align}
</script>
</p>
<p>因此<strong>the standard practice of reporting<sup id="fnref:Q1"><a class="footnote-ref" href="#fn:Q1" rel="footnote">1</a></sup></strong> $\hat{\beta}\pm 2\cdot se(\hat{\beta})$意味着大约$95\%$的置信区间。即便没有高斯误差的假设，区间也近似正确，因为当样本规模$N\sim \infty$时，覆盖范围近似为$1-2\alpha$。</p>
<p>运用近似的方法我们可以得到全体系数向量$\beta$的近似置信集，记作</p>
<p>
<script type="math/tex; mode=display">
C_{\beta} = \{\beta \mid (\hat{\beta}-\beta\mathbf\bf{X^TX}(\hat{\beta}-\beta)\le \hat{\sigma}^2\chi^{2^{(1-\alpha)}}_{p+1} \}
</script>
</p>
<p>其中，$\chi_\ell^{2^{(1-\alpha)}}$是$\ell$个自由度的卡方分布的$1-\alpha$的分位数：举个例子，$\chi^{2^{(1-0.05)}}<em>5=11.1,\chi^{2^{(1-0.1)}}_5=9.2$。这个关于$\beta$的置信集导出关于真函数$f(x)=x^T\beta$对应的置信集，记作${x^T\beta\mid \beta \in C</em>\beta}$（练习3.2；并见5.2.2节中函数置信集<sup id="fnref:confidence bands"><a class="footnote-ref" href="#fn:confidence bands" rel="footnote">2</a></sup>的例子图5.4）</p>
<h2 id="_2">例子：前列腺癌</h2>
<p>这个例子的数据来自1989年Stamey等人的研究。他们检验即将接受彻底前列腺切除术男性的前列腺特定抗原水平和一系列临床措施之间的相关性。变量是癌体积的对数值（lcavol）、前列腺重量的对数值（lweight）、良性前列腺增生数量（lbph）、精囊浸润（svi）、包膜浸透的对数值（lcp）、Gleason得分（gleason）、Gleason得分为4或5的比例（pgg45）。表3.1中给出的预测变量的相关性矩阵显示了很多强的相关性。第1章的图1.1（第3页）是散点图矩阵，显示了变量间的每一对图像。我们看到svi是二进制变量，gleason是有序分类变量。举个例子，我们看到lcavol和lcp都与响应变量lpsa有强的相关性。我们需要拟合联合的影响去解开预测变量和响应变量之间的关系。</p>
<p><img alt="" src="../../img/03/tab3.1.png" /></p>
<p>表3.1 前列腺癌数据中预测变量的相关系数
表3.2 前列腺癌数据的线性模型拟合。$Z$分数为系数除以标准误差（3.12）。大体上，$Z$分数绝对值大于2表示在$p=0.05$的水平下显著不为零。</p>
<p>我们对前列腺特定抗原的对数值lpsa和经过一次标准化有单位方差的预测变量进行线性模型拟合。我们随机将数据集分离得到规模为67的训练集以及规模为30的测试集。我们对训练集应用最小二乘估计得到表3.2中的估计值、标准误差以及$Z$分数。$Z$分数定义式为（3.12），并且衡量了从模型中去掉该变量的影响。在$5\%$的水平下，$Z$分数的绝对值大于2近似显著。（在我们的例子中，我们有9个参数，$t_{67-9}$的分布的0.025尾分位数是$\pm 2.002$!） 预测变量lcavol显示了最强的影响，lweight和svi的影响同样显著。注意到lcp不是显著，一旦lcavol在模型中（当使用一个没有lcavol的模型，lcp是强显著的）。我们也可以马上除去一些项用$F$统计量（3.13）来测试。举个例子，我们考虑除掉表3.2中所有不显著的项，age,lcp,gleason以及pgg45。我们得到</p>
<p>
<script type="math/tex; mode=display">
F=\dfrac{(32.81-29.43)/(9-5)}{29.43/(67-9)}=1.67\qquad (3.16)
</script>
</p>
<p>其中，$p$值为0.17（$Pr(F_{4,58}&gt;1.67)=0.17$）,因此不是显著的。</p>
<p>测试数据的平均预测误差为0.521。相反地，使用lpsa训练数据的平均值预测的测试误差为1.057，称作“基本误差阶”因此线性模型将基本误差阶降低了大概$50\%$。下文中我们将要回到这个例子来比较不同的选择和收缩方法。</p>
<h2 id="guass-markov">Guass-Markov定理</h2>
<p>统计学中一个很有名的结论称参数$\beta$的最小二乘估计在所有的线性无偏估计中有最小的方差。我们将要严谨地说明这一点，并且说明限制为无偏估计不是明智的选择。这个结论导致我们考虑本章中像Ridge回归的有偏估计。我们考虑任意参数$\theta = a^T\beta$的线性组合，举个例子，预测值$f(x_0)=x_0^T\beta$是这种形式。$a^T\beta$的最小二乘估计为</p>
<p>
<script type="math/tex; mode=display">
\hat{\theta}=a^T\hat{\beta}=a^T\mathbf{(X^TX)^{-1}X^Ty}\qquad (3.17)
</script>
</p>
<p>考虑$\mathbf{X}$固定，这是关于响应变量$\mathbf{y}$的线性函数$\mathbf{c}_0^T\mathbf{y}$。如果我们假设线性模型是正确的，$a^T\hat{\beta}$是无偏的，因为
<script type="math/tex; mode=display">
\begin{align}
E(a^T\hat{\beta})&=E(a^T\mathbf{(X^TX)^{-1}X^Ty})\\\\
&=a^T\mathbf{(X^TX)^{-1}X^TX}\beta\\\\
&=a^T\beta\qquad (3.18)
\end{align}
</script>
</p>
<p>Gauss-Markov定理说如果我们有$a^T\beta$的其它无偏估计$\tilde{\theta}=\mathbf{c}^T\mathbf{y}$,也就是$E(\mathbf{c}^T\mathbf{y})=a^T\beta$,则</p>
<p>
<script type="math/tex; mode=display">
Var(a^T\hat{\beta})\le Var(\mathbf{c}^T\mathbf{y})\qquad (3.19)
</script>
</p>
<p>该证明（习题3.3）运用三角不等式。为了简化我们已经用单个参数$a^T\beta$估计来叙述结果，但是再加点新的定义我们可以用整个参数向量$\beta$来说明（练习3.3）</p>
<p>考虑$\theta$估计$\tilde{\theta}$的均方误差</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
MSE(\tilde{\theta})&=E(\tilde{\theta}-\theta)^2\\\\
&=Var(\tilde{\theta})+[E(\tilde{\theta})-\theta]^2\qquad (3.20)
\end{align}
</script>
</p>
<p>第一项为方差，第二项为平方偏差。Gauss-Markov定理表明最小二乘估计在所有无偏线性估计中有最新奥的均方误差。然而，或许存在有较小均方误差的有偏估计。这样的估计<strong>trade a little for </strong>。有偏估计经常使用。任何收缩或者将最小二乘的一些参数设为0的方法都可能导致有偏估计。我们将在章节的后面讨论许多例子，包括变量子集选择和<strong>Ridge</strong> 回归。从一个更加实际的观点来看，许多模型是对事实的曲解，因此是有偏的；挑选一个合适的模型意味着要在偏差和方差之间创造某种良好的平衡。我们将在第7章中详细讨论这些问题。</p>
<p>正如在第2章中讨论的那样，均方误差与预测的正确性紧密相关。考虑在输入$x_0$处的新响应的预测</p>
<p>
<script type="math/tex; mode=display">
Y_0=f(x_0)+\varepsilon_0 \qquad (3.21)
</script>
</p>
<p>则估计$\tilde{f}(x_0)=x_0^T\tilde{\beta}$的预测误差期望值为</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
E(Y_0-\tilde{f}(x_0))^2 &=\sigma^2+E(x_0^T\tilde{\beta}-f(x_0))^2\\
&= \sigma^2+MSE(\tilde{f}(x_0))\qquad (3.22)
\end{align}
</script>
</p>
<p>因此，预测误差的估计值和均方误差只有常数值$\sigma^2$的差别，$\sigma^2$表示新观测$y_0$的方差。</p>
<h2 id="_3">从简单单变量回归到多重回归</h2>
<p>有$p&gt;1$个输入的线性模型（3.1）称作多重线性回归模型。模型（3.6）的最小二乘估计用单（$p=1$）变量线性模型的估计最好理解，我们将在这部分指出。</p>
<p>首先假设我们有一个没有截距的单变量模型，这就是</p>
<p>
<script type="math/tex; mode=display">
Y=X\beta + \varepsilon \qquad (3.23)
</script>
</p>
<p>最小二乘估计和残差为</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\hat{\beta}&=\dfrac{\sum_1^Nx_iy_i}{\sum_1^Nx_i^2}\\\\
r_i &= y_i -x_i\hat{\beta}
\end{align}
\qquad (3.24)
</script>
</p>
<p>为了简便用向量表示，我们令$\mathbf{y}=(y_1,\ldots,y_N)^T$,$\mathbf{x}=(x_1,\ldots,x_N)^T$，并且定义
<script type="math/tex; mode=display">
\begin{align}
\langle\mathbf{x},\mathbf{y}\rangle &= \sum\limits_{i=1}^Nx_iy_i\\
&=\mathbf{x^Ty}\qquad (3.25)
\end{align}
</script>
</p>
<p>$\mathbf{x}$和$\mathbf{y}$之间的内积，于是我们可以写成</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\hat{\beta}&=\dfrac{\langle \mathbf{x,y}\rangle}{\langle\mathbf{x,x} \rangle}\\
\mathbf{r}&=\mathbf{y}-\mathbf{x}\hat{\beta}
\end{align}
\qquad (3.26)
</script>
</p>
<p>正如我们所看到的，这个简单的单变量回归提供了多重线性回归的框架（building block）。进一步假设输入$\mathbf{x}_1,\mathbf{x_2,\ldots,x_p}$（数据矩阵$\mathbf{X}$的列）是正交的；也就是对于所有的$j\neq k$有$\langle x_j,x_k\rangle=0$。于是很容易得到多重最小二乘估计$\hat{\beta}_j$等于$\langle \mathbf{x}_j,\mathbf{y}\rangle/\langle\mathbf{x}_j,\mathbf{x}_j\rangle $——单变量估计。换句话说，当输入变量为正交的，它们对模型中其它的参数估计没有影响。</p>
<p>正交输入变量经常发生于平衡的、设定好的实验（强制了正交），但是对于实验数据几乎不会发生。因此为了后面实施这一想法我们将要对它们进行正交化。进一步假设我们有一个截距和单输入$\bf{x}$。则$\bf{x}$的最小二乘系数有如下形式</p>
<p>
<script type="math/tex; mode=display">
\hat{\beta}_1=\dfrac{\langle \mathbf{x}-\bar{x}\mathbf{1},\mathbf{y}\rangle}{\langle \mathbf{x}-\bar{x}\mathbf{1},\mathbf{x}-\bar{x}\mathbf{1}\rangle}\qquad (3.27)
</script>
</p>
<p>其中，$\bar{x}=\sum_ix_i/N$,且$N$维单位向量$\mathbf{1}=x_0$。我们可以将式（3.27）的估计看成简单回归（3.26）的两次应用。这些步骤是：
1. 在$\bf{1}$上回归$\bf{x}$产生残差$\mathbf{z}=\mathbf{x}-\bar{x}\mathbf{1}$;
2. 在残差$\bf{z}$上回归$\bf{y}$得到系数$\hat{\beta}_1$
   在这个过程中，“在$\bf{a}$上回归$\bf{b}$”意思是$\bf{b}$在$\bf{a}$上的无截距的简单单变量回归，产生系数$\hat{\gamma}=\langle\mathbf{a,b}\rangle/\langle\mathbf{a,a}\rangle$以及残差向量$\mathbf{b}-\hat{\gamma}\mathbf{a}$。我们称$\bf{b}$由$\bf{a}$校正[^adjusted for],或者关于$\bf{a}$正交化。</p>
<p>第一步对$\mathbf{x}$作关于$\mathbf{x}_0=\mathbf{1}$的正交化。第二步是一个利用正交预测变量$\mathbf{1}$和$\mathbf{z}$简单的单变量回归。图3.4展示了两个一般输入$\mathbf{x}_1$和$\mathbf{x}_2$的过程。正交化不会改变由$\mathbf{x}_1$和$\mathbf{x}_2$张成的子空间，它简单地产生一个正交基来表示子空间。</p>
<p><img alt="" src="../../img/03/fig3.4.png" /></p>
<p>正交输入的最小二乘回归。向量$\mathbf{x}_2$在向量$\mathbf{x}_1$上回归，得到残差向量$\mathbf{z}$。$\mathbf{y}$在$\mathbf{z}$上的回归给出$\mathbf{x}_2$的系数。把$\mathbf{y}$在$\mathbf{x}_1$和$\mathbf{z}$上的投影加起来给出了最小二乘拟合$\mathbf{\hat{y}}$.</p>
<p>这个方法一般化为$p$个输入的情形，如算法3.1所示。注意到第二步的输入$\mathbf{z}<em>0,\ldots,\mathbf{z}</em>{j-1}$是正交的，因此这里计算得到的简单回归的系数实际上是多重回归的系数。</p>
<p><img alt="" src="../../img/03/Alg3.1.png" /></p>
<hr />
<p><strong>算法 3.1</strong> 依次正交的回归</p>
<hr />
<ol>
<li>初始化 $\mathbf{z}_0=\mathbf{x}_0=\mathbf{1}$</li>
<li>对于 $j=1,2,\ldots,p$
    在$\mathbf{z}<em>0,\mathbf{z}_1,\ldots,\mathbf{z}</em>{j-1}​$上对$\mathbf{x}<em>j​$回归得到系数$\hat{\gamma}</em>{\ell j}=\langle \mathbf{z}<em>{\ell},\mathbf{x}_j \rangle/\langle\mathbf{z}</em>{\ell},\mathbf{z}<em>{\ell}\rangle,\ell=0,\ldots,j-1$以及残差向量$\mathbf{z}_j=\mathbf{x}_j-\sum</em>{k=0}^{j-1}\hat{\gamma}_{kj}\mathbf{z}_k$</li>
<li>在残差$\mathbf{z}_p$上回归$\mathbf{y}$得到系数$\hat{\beta}_p$</li>
</ol>
<hr />
<p>算法的结果为
<script type="math/tex; mode=display">
\hat{\beta}_p=\dfrac{\langle \mathbf{z}_p,\mathbf{y} \rangle}{\langle \mathbf{z}_p,\mathbf{z}_p \rangle}\qquad (3.28)
</script>
</p>
<p>对第二步中的残差进行重排列，我们可以看到每个$\mathbf x_j​$是$\mathbf z_k,k\le j​$的线性组合。因为$\mathbf z_j​$是正交的，它们形成了$\mathbf{X}​$列空间的基，从而得到最小二乘在子空间上投影为$\hat{\mathbf{y}}​$。因为$\mathbf z_p​$仅与$\mathbf x_p​$有关(系数为1)，我们可以看到系数(3.28)确实是$\mathbf{y}​$在$\mathbf x_p​$上多重回归的系数。这一重要结果揭示了在多重回归中相关输入的影响。注意到通过对$\mathbf x_j​$重排列，任何其中一个都有可能是最后一个，然后得到一个类似的结果。因此一般来说，我们已经展示了多重回归的第$j​$个系数是$\mathbf{y}​$在$\mathbf x_{j\cdot 012&hellip;(j-1)(j+1)&hellip;,p}​$的单变量回归，$\mathbf x_{j\cdot 012&hellip;(j-1)(j+1)&hellip;,p}​$是$\mathbf{x}_j​$</p>
<p>在$\mathbf x_0,\mathbf x_1,&hellip;,\mathbf x_{j-1},\mathbf{j+1},&hellip;,\mathbf{x}_p​$回归后的残差向量：
<em>多重回归系数$\hat\beta_j​$表示$\mathbf x_j​$经过$\mathbf{x}<em>0,\mathbf{x}_1,\ldots,\mathbf{x}</em>{j-1},\mathbf{x}_{j+1},\ldots,\mathbf{x}_p​$调整后$\mathbf{x}_j​$对$\mathbf{y}​$多余的贡献</em></p>
<p>如果$\mathbf{x}_p$与某些$\mathbf{x}_k$高度相关，残差向量$\mathbf{z}_p$会近似等于0，而且由(3.28)得到的系数$\hat{\beta}_p$会非常不稳定。在相关集对于所有的变量都是正确的。在这些情形下我们可能得到所有的Z分数（表3.2所示）都很小——集中的任何一个都可以删掉——然而我们不可能删掉所有。由（3.28）我们也得到估计方差（3.8）的另一种方法
<script type="math/tex; mode=display">
Var(\hat{\beta}_p)=\dfrac{\sigma^2}{\langle \mathbf{z}_p,\mathbf{z}_p \rangle}=\dfrac{\sigma^2}{\Vert\mathbf{z}_p\Vert ^2}\qquad (3.29)
</script>
</p>
<p>换句话说，我们估计$\hat{\beta}_p$的精度取决于残差向量$\mathbf{z}_p$的长度;它表示$\mathbf{x}_p$不能被其他$\mathbf{x}_k$解释的程度。</p>
<p>算法3.1被称作多重回归的Gram-Schmidt正交化，也是一个计算估计的有用的数值策略。我们不仅从中不仅可以得到$\hat{\beta}_p$,而且可以得到整个多重最小二乘拟合，如练习3.4所示。</p>
<p>我们可以用矩阵形式来表示算法3.1的第二步：</p>
<p>
<script type="math/tex; mode=display">
\mathbf{X=Z\Gamma}\qquad (3.30)
</script>
</p>
<p>其中$\mathbf{Z}$是$\mathbf{z_j}$（按顺序）作为列向量的矩阵，$\mathbf{\Gamma}$是值为$\hat{\gamma}<em>{kj}$的上三角矩阵。引入第$j$个对角元$D</em>{jj}=\Vert \mathbf{z}_j \Vert$的对角矩阵$\mathbf{D}$，我们有
<script type="math/tex; mode=display">
\begin{align}
\mathbf{X}&=\mathbf{ZD^{-1}D\Gamma}\\\\
&=\mathbf{QR}\qquad (3.31)
\end{align}
</script>
</p>
<p>称为矩阵$\mathbf{X}$的QR分解。这里$\mathbf{Q}$为$N\times (p+1)$正交矩阵，$\mathbf{Q^TQ=I}$,并且$\mathbf{R}$为$(p+1)\times (p+1)$上三角矩阵。</p>
<p>$\mathbf{QR}$分解表示了$\mathbf{X}$列空间的一组方便的正交基。举个例子，很容易可以看到，最小二乘的解由下式给出
<script type="math/tex; mode=display">
\begin{align}
\hat{\beta}&=\mathbf{R^{-1}Q^Ty}\qquad (3.32) \\\\
\hat{\mathbf{y}}&=\mathbf{QQ^Ty}\qquad (3.33)
\end{align}
</script>
</p>
<p>等式（3.32）很容易求解，因为$\mathbf{R}$为上三角（练习3.4）</p>
<h2 id="_4">多重输出</h2>
<p>假设我们有多重输出$Y_1,Y_2,\ldots,Y_K$，我们希望通过我们的输入$X_0,X_1,X_2,\ldots,X_p$去预测。我们假设对于每一个输出有线性模型</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
Y_k&=\beta_{0k}+\sum\limits_{j=1}^pX_j\beta_{jk}+\varepsilon_k \qquad (3.34)\\\\
&= f_k(X)+\varepsilon_k \qquad (3.35)
\end{align}
</script>
</p>
<p>有$N$个训练情形时我们可以将模型写成矩阵形式</p>
<p>
<script type="math/tex; mode=display">
\mathbf{Y=XB+E}\qquad (3.36)
</script>
</p>
<p>这里$\mathbf{Y}$为$N\times K$的响应矩阵，$ik$处值为$y_{ik}$，$\mathbf{X}$为$N\times (p+1)$的输入矩阵，$\mathbf{B}$为$(p+1)\times K$的系数矩阵 $\mathbf{E}$为$N\times K$的误差矩阵。单变量损失函数（3.2）的直接推广为
<script type="math/tex; mode=display">
\begin{align}
RSS(\mathbf{B})&=\sum\limits_{k=1}^K\sum\limits_{i=1}^N(y_{ik}-f_k(x_i))^2\qquad (3.37)
&= tr[\mathbf{(Y-XB)^T(Y-XB)}]\qquad (3.38)
\end{align}
</script>
</p>
<p>最小二乘估计有前面一样的形式</p>
<p>
<script type="math/tex; mode=display">
\mathbf{\hat{B}=(X^TX)^{-1}X^TY}\qquad (3.39)
</script>
</p>
<p>因此第$k$个输出的系数恰恰是$\mathbf{y}_k$在$\mathbf{x}_0,\mathbf{x}_1,\ldots,\mathbf{x}_p$上回归的最小二乘估计。多重输出不影响其他的最小二乘估计。</p>
<p>如果式（3.34）中的误差$\varepsilon = (\varepsilon_1,\ldots,\varepsilon_K)$相关，则似乎修正（3.37）有利于多重变量版本更加恰当。特别地，假设$Cov(\varepsilon)=\Sigma$,则多重变量加权准则为</p>
<p>
<script type="math/tex; mode=display">
RSS(\mathbf{B;\Sigma})=\sum\limits_{i=1}^N(y_i-f(x_i))^T\Sigma^{-1}(y_i-f(x_i))\qquad (3.40)
</script>
</p>
<p>由多变量高斯定理自然得出。这里$f(x)$为向量函数$(f_1(x),\ldots,f_K(x))$,而且$y_i$为观测值$i$的$K$维响应向量。然而，可以证明解由式（3.39）给出；$K$个分离的回归忽略了相关性（练习3.11）。如果$\Sigma_i$不同观测为不同值，则不再是这种情形，而且关于$\mathbf{B}$的解不再退耦[^decouple]</p>
<p>在3.7节我们继续讨论多重输出的问题，并且考虑需要结合回归的情形。</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:Q1">
<p>怎么翻译？？&#160;<a class="footnote-backref" href="#fnref:Q1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:confidence bands">
<p>置信集？？&#160;<a class="footnote-backref" href="#fnref:confidence bands" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:inner product">
<p>The inner-product notation is suggestive of generalizations of linear regression to different metric spaces, as well as to probability spaces. 内积表示是线性回归模型一般化到不同度量空间（包括概率空间）建议的方式。&#160;<a class="footnote-backref" href="#fnref:inner product" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>

<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */

var disqus_config = function () {
    this.page.url = "https://szcf-weiya.github.io/ESL-CN/03 Linear Methods for Regression/3.2 Linear Regression Models and Least Squares/";  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = "https://szcf-weiya.github.io/ESL-CN/03 Linear Methods for Regression/3.2 Linear Regression Models and Least Squares/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//weiya.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//weiya.disqus.com/count.js" async></script></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright &copy; 2016-2017 weiya</center>
            
            <center>Powered by <a href="http://www.mkdocs.org/">MkDocs</a> and <a href="http://bootswatch.com/yeti/">Yeti</a></center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
	<script src="../../js/jquery.dropdown.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">搜索</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            请在下面输入你要搜索的文本（仅支持英文）：
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="搜索..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>